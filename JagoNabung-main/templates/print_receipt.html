<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Struk Transaksi - Fajar Mandiri Store Tabungan</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        @media print {
            .no-print { display: none !important; }
            .print-container { 
                max-width: 58mm; 
                font-size: 12px; 
                margin: 0;
                padding: 0;
            }
            body { margin: 0; padding: 0; }
        }
        .receipt-paper {
            max-width: 300px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border: 1px dashed #ccc;
            font-family: 'Courier New', monospace;
        }
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .border-bottom { border-bottom: 1px dashed #333; }
        .my-2 { margin: 8px 0; }
        .py-1 { padding: 4px 0; }
    </style>
</head>
<body class="bg-light">
    <div class="container-fluid p-3">
        <div class="no-print text-center mb-3">
            <button onclick="window.print()" class="btn btn-primary me-2">
                <i class="fas fa-print"></i> Cetak Struk
            </button>
            <button onclick="window.close()" class="btn btn-secondary">
                <i class="fas fa-times"></i> Tutup
            </button>
        </div>
        
        <div class="print-container receipt-paper">
            <!-- Header -->
            <div class="text-center border-bottom py-1">
                <div style="font-size: 18px; font-weight: bold;">FAJAR MANDIRI STORE</div>
                <div style="font-size: 14px;">TABUNGAN</div>
                <div style="font-size: 12px;">Jalan Pasirwangi RT001 RW011 KEC.Lembang KAB.BANDUNG BARAT KODEPOS 40391</div>
                <div style="font-size: 12px;">Telp: 0818-0441-1937 | Email: info@fajarmandiri.store</div>
            </div>
            
            <!-- Transaction Info -->
            <div class="my-2">
                <div>No. Transaksi: {{ transaction.id }}</div>
                <div>Tanggal: {{ format_date_indonesian(transaction.date) }}</div>
                <div>Waktu: {{ transaction.created_at.strftime('%H:%M:%S') }}</div>
            </div>
            
            <div class="border-bottom py-1"></div>
            
            <!-- Customer Info -->
            <div class="my-2">
                <div><strong>PENABUNG:</strong></div>
                <div>{{ transaction.saver.name }}</div>
                {% if transaction.saver.phone %}
                <div>{{ transaction.saver.phone }}</div>
                {% endif %}
            </div>
            
            <div class="border-bottom py-1"></div>
            
            <!-- Transaction Details -->
            <div class="my-2">
                <div style="display: flex; justify-content: space-between;">
                    <span><strong>JENIS TRANSAKSI:</strong></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>{% if transaction.type == 'deposit' %}SETORAN{% else %}PENARIKAN{% endif %}</span>
                </div>
                
                <div style="display: flex; justify-content: space-between; margin-top: 8px;">
                    <span><strong>JUMLAH:</strong></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span style="font-size: 16px; font-weight: bold;">{{ format_currency(transaction.amount) }}</span>
                </div>
                
                {% if transaction.description %}
                <div style="margin-top: 8px;">
                    <div><strong>KETERANGAN:</strong></div>
                    <div>{{ transaction.description }}</div>
                </div>
                {% endif %}
            </div>
            
            <div class="border-bottom py-1"></div>
            
            <!-- Balance Info -->
            <div class="my-2">
                <div style="display: flex; justify-content: space-between;">
                    <span><strong>SALDO SETELAH:</strong></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span style="font-size: 16px; font-weight: bold;">{{ format_currency(transaction.balance_after) }}</span>
                </div>
            </div>
            
            <div class="border-bottom py-1"></div>
            
            <!-- Footer -->
            <div class="text-center my-2" style="font-size: 11px;">
                <div>Terima kasih atas kepercayaan Anda</div>
                <div>Simpan struk ini sebagai bukti</div>
                <div>transaksi yang sah</div>
                <div style="margin-top: 8px;">{{ transaction.created_at.strftime('%d/%m/%Y %H:%M:%S') }}</div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <script>
        // Auto print when page loads (optional)
        // window.onload = function() { window.print(); }
    </script>
</body>
</html>